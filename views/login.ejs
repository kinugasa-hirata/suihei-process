<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ°´å¹³ãƒã‚ºãƒ«æ¤œæŸ»æˆç¸¾æ›¸</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <style>
    body {
      font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
      background-color: #f5f5f5;
      padding: 20px 0;
    }
    .container { max-width: 1200px; background: white; padding: 30px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .inspection-sheet { background: white; padding: 20px; border: 2px solid #000; }
    .inspection-header { margin-bottom: 20px; }
    .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .header-title { text-align: center; font-size: 24px; font-weight: bold; flex-grow: 1; }
    .company-name { text-align: right; font-size: 18px; font-weight: bold; }
    .header-info { display: flex; justify-content: space-between; flex-wrap: wrap; font-size: 14px; margin-bottom: 10px; }
    .header-info > div { margin-right: 20px; margin-bottom: 5px; }
    .environment-note { font-size: 12px; margin: 15px 0; padding: 10px; background-color: #f8f9fa; border-left: 4px solid #0d6efd; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 10px; }
    th, td { border: 1px solid #000; padding: 4px 2px; text-align: center; vertical-align: middle; }
    th { background-color: #e9ecef; font-weight: bold; font-size: 10px; }
    .header-cell { background-color: #d3d3d3; font-weight: bold; }
    .measurement-cell { min-width: 35px; }
    .tolerance-row { background-color: #f8f9fa; font-size: 10px; }
    .invalid-value { color: #dc3545; font-weight: bold; }
    .rotate-text { writing-mode: vertical-rl; text-orientation: mixed; white-space: nowrap; }
    .result-cell { font-weight: bold; }
    .footer-note { margin-top: 20px; font-size: 12px; padding: 10px; background-color: #fff3cd; border-left: 4px solid #ffc107; }
    .btn-container { margin-bottom: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="btn-container">
      <a href="/" class="btn btn-secondary">â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
      <button onclick="window.print()" class="btn btn-primary">ğŸ–¨ï¸ å°åˆ· / PDFä¿å­˜</button>
    </div>

    <div class="inspection-sheet">
      <div class="inspection-header">
        <div class="header-row">
          <div class="header-title">æ°´å¹³ãƒã‚ºãƒ«å…¨æ•°æ¤œæŸ»æˆç¸¾æ›¸</div>
          <div class="company-name">ãˆ±å¹³ç”°å•†åº—</div>
        </div>

        <div class="header-info">
          <div><strong>å“å:</strong> æ°´å¹³ãƒã‚ºãƒ«</div>
          <div><strong>ä»•æ§˜æ›¸ç•ªå·:</strong> KDMP-0434</div>
          <div><strong>æ‹…å½“è€…:</strong> <%= displayName %></div>
        </div>

        <div class="header-info">
          <div><strong>å›³ç•ª:</strong> P2MM302000</div>
          <div><strong>æ•°é‡:</strong> <%= files.length %>å€‹</div>
          <div><strong>æ¤œæŸ»æ–¹æ³•:</strong> å…¨æ•°æ¤œæŸ»</div>
          <div><strong>æ¤œæŸ»æ—¥:</strong> <%= new Date().toLocaleDateString('ja-JP', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\//g, '/') %></div>
          <div><strong>ç´æœŸ:</strong> YYYY/MM/DD</div>
        </div>
      </div>

      <div class="environment-note">
        å½“ç¤¾æ¤œæŸ»ã«ãŠã‘ã‚‹ç’°å¢ƒã¯å®¤æ¸©20â„ƒÂ±5â„ƒã€æ¹¿åº¦40%Â±25%ã§ç®¡ç†ã•ã‚ŒãŸéƒ¨å±‹ã§å®Ÿæ–½ã—ã¦ãŠã‚Šã¾ã™ã€‚
      </div>

      <div style="margin-top: 15px; text-align: right; font-weight: bold;">å˜ä½ (mm)</div>
      
      <table>
        <thead>
          <tr>
            <th rowspan="3" style="width: 60px;">å›³é¢å¯¸æ³•</th>
            <th>8.2</th><th>37.5</th><th>15.9</th><th>24.1</th><th>Î¦11.2</th><th>Î¦3.2<br>å…¨å‘¨</th>
            <th>Î¦8.0</th><th>æ·±ã•5.0</th><th>P.C.D 30</th><th>Î¦155.4</th><th>83.1</th><th>Î¦122.3</th>
            <th rowspan="3">æ‹¡ã‚åˆ<br>ã„</th><th rowspan="3">ç›®è¦–ç‚¹<br>æ¤œ</th><th rowspan="3">(å‚è€ƒ<br>å€¤)</th>
          </tr>
          <tr>
            <th>Â±0.2</th><th>Â±0.3</th><th>Â±0.2</th><th>Â±0.2</th><th>+0.2/0</th><th>Â±0.1</th>
            <th>Â±0.2</th><th>Â±0.1</th><th>Â±0.2</th><th>Â±0.5</th><th>Â±0.3</th><th>Â±0.5</th>
          </tr>
          <tr class="header-cell">
            <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th>
            <th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th>
          </tr>
          <tr class="tolerance-row">
            <th>ä¸Šé™å€¤</th>
            <th>8.4</th><th>37.8</th><th>16.1</th><th>24.3</th><th>11.4</th><th>3.3</th>
            <th>8.2</th><th>5.1</th><th>30.2</th><th>155.9</th><th>83.4</th><th>122.8</th>
            <th>-</th><th>-</th><th>-</th>
          </tr>
          <tr class="tolerance-row">
            <th>ä¸‹é™å€¤</th>
            <th>8.0</th><th>37.2</th><th>15.7</th><th>23.9</th><th>11.2</th><th>3.1</th>
            <th>7.8</th><th>4.9</th><th>29.8</th><th>154.9</th><th>82.8</th><th>121.8</th>
            <th>-</th><th>-</th><th>-</th>
          </tr>
          <tr class="header-cell">
            <th>æ¸¬å®šå™¨</th>
            <th colspan="2">ä¸‰æ¬¡å…ƒæ¸¬å®šå™¨</th><th colspan="2">ä¸‰æ¬¡å…ƒæ¸¬å®šå™¨</th><th colspan="2">ãƒ”ãƒ³ã‚²ãƒ¼ã‚¸</th>
            <th colspan="2">ä¸‰æ¬¡å…ƒæ¸¬å®šå™¨</th><th colspan="5">ä¸‰æ¬¡å…ƒæ¸¬å®šå™¨</th>
            <th>æ²»å…·</th><th>ç›®è¦–</th><th>ç§¤</th>
          </tr>
          <tr class="header-cell">
            <th>è¨˜è¼‰äº‹é …</th>
            <th colspan="2">æ¸¬å®šå€¤</th><th colspan="2">æ¸¬å®šå€¤</th><th colspan="2">åˆå¦</th>
            <th colspan="2">æ¸¬å®šå€¤</th><th colspan="5">æ¸¬å®šå€¤</th>
            <th>åˆå¦</th><th>åˆå¦</th><th>é‡é‡(g)</th>
          </tr>
        </thead>
        <tbody>
          <% files.forEach(function(file) { 
            var measurements = fileData[file.$id];
            var fileNumber = file.filename.replace(/\.txt$/i, '');
          %>
          <tr>
            <td><strong><%= fileNumber %></strong></td>
            <td class="measurement-cell <%= !measurements.A.isValid ? 'invalid-value' : '' %>"><%= measurements.A.value %></td>
            <td class="measurement-cell <%= !measurements.B.isValid ? 'invalid-value' : '' %>"><%= measurements.B.value %></td>
            <td class="measurement-cell <%= !measurements.C.isValid ? 'invalid-value' : '' %>"><%= measurements.C.value %></td>
            <td class="measurement-cell <%= !measurements.D.isValid ? 'invalid-value' : '' %>"><%= measurements.D.value %></td>
            <td class="result-cell <%= !measurements.E.isValid ? 'invalid-value' : '' %>"><%= measurements.E.isValid ? 'åˆ' : 'å¦' %></td>
            <td class="result-cell <%= !measurements.F.isValid ? 'invalid-value' : '' %>"><%= measurements.F.isValid ? 'åˆ' : 'å¦' %></td>
            <td class="result-cell <%= !measurements.G.isValid ? 'invalid-value' : '' %>" 
                <% if (!measurements.G.isValid && measurements.G.value !== '-') { %>
                  title="ä¸åˆæ ¼: <%= measurements.G.value %>"
                <% } %>>
              <%= measurements.G.isValid ? 'åˆ' : 'å¦' %>
            </td>
            <td class="measurement-cell <%= !measurements.H.isValid ? 'invalid-value' : '' %>"><%= measurements.H.value %></td>
            <td class="measurement-cell <%= !measurements.I.isValid ? 'invalid-value' : '' %>"><%= measurements.I.value %></td>
            <td class="measurement-cell <%= !measurements.J.isValid ? 'invalid-value' : '' %>"><%= measurements.J.value %></td>
            <td class="measurement-cell <%= !measurements.K.isValid ? 'invalid-value' : '' %>"><%= measurements.K.value %></td>
            <td class="measurement-cell <%= !measurements.L.isValid ? 'invalid-value' : '' %>"><%= measurements.L.value %></td>
            <td class="result-cell">-</td>
            <td class="result-cell">-</td>
            <td class="measurement-cell"><%= file.weight ? Number(file.weight).toFixed(1) : '-' %></td>
          </tr>
          <% }); %>
        </tbody>
      </table>

      <div class="footer-note">
        â€»ç€è„±å®¹æ˜“ãªã‚·ãƒ¼ãƒ«ã«è­˜åˆ¥ç•ªå·ã‚’è¨˜è¼‰ã—è£½å“è£ã®åº•é¢ã«è²¼ã‚Šä»˜ã‘ã‚‹ã€‚
      </div>
    </div>
  </div>
</body>
</html>